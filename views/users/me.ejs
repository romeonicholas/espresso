<%- include('../includes/row-opening') %>
  <%- include('../includes/nav') %>
    <div class="center col-6 col-s-9">
      <h2 class="subheader">My Dashboard</h2>
        <header class="dashboard-section-header">
          <h3 class="subheader">My Shots</h3>
          <span class="header-links"><a class="link" href="/shots/new"><strong>Pull a New Shot</strong></a></span>
        </header>
        <div class="section-underline"></div>
      
        <div>  
          <% if (!user.beans.length || !user.machines.length || !user.grinders.length) { %>
            <p>You can't record a shot without equipment! Add at least one variety of <a class="link" href="/users/me/beans/new">beans</a>, one <a class="link" href="/users/me/machines/new">machine</a>, and one <a class="link" href="/users/me/grinders/new">grinder</a> to your account, then try again.</p>
            <br />
          <% } %>
          
          <br />

          <% if (user.shots.length) { %>
            <table class="dashboard-table">
              <thead>
                <tr>
                  <th>Details</th>
                  <th>Date</th>
                  <th colspan="5">Ratings</th>
                  <th>Delete</th>
                </tr>
              </thead>
              <tbody>
                <% user.shots.forEach(shot => { %>
                  <tr>
                    <td><a class="link" href="/shots/<%= shot._id %>">-></a></td>
                    <td class="dashboard-date"><%= shot.date.toLocaleString("en-US", { dateStyle: "short", timeStyle: "short"}) %></td>
                    <td><%= shot.aromaticsRating %></td>
                    <td><%= shot.bodyRating %></td>
                    <td><%= shot.acidityRating %></td>
                    <td><%= shot.sweetnessRating %></td>
                    <td><%= shot.aftertasteRating %></td>
                    <td><a class="link" href='/shots/<%= shot.id %>/delete'>[x]</a></td>
                  </tr>
                <% }) %>
              </tbody>
              <tfoot>
                <tr>
                  <td colspan="8">
                    <a class="link" href="/users/me/shots">See entire shot history</a>
                  </td>
                </tr>
              </tfoot>
            </table>
          <% } %>
        </div>
      
        <header class="dashboard-section-header">
          <h3>My Beans</h3>
          <span class="header-links"><a class="link" href="/users/me/beans/new">Add Beans</a></span>
        </header>
        <div class="section-underline"></div>
        
        <div>
          <% if (user.beans.length) { %>
            <% user.beans.forEach(bean => { %>
              <p><strong><%= bean.brand %></strong> <%= bean.name %> <a class="link delete" href='/users/me/beans/<%= bean.id %>/delete'>[x]</a></p>
            <% }) %>
          <% } else { %>
            <p>No beans here :(</p>
          <% } %>
        </div>

        <header class="dashboard-section-header">
          <h3>My Machines</h3>
          <span class="header-links"><a class="link" href="/users/me/machines/new">Add Machines</a></span>
        </header>
        <div class="section-underline"></div>
        
        <div>
          <% if (user.machines.length) { %>
            <% user.machines.forEach(machine => { %>
              <p><strong><%= machine.brand %></strong> <%= machine.name %> <a class="link delete" href='/users/me/machines/<%= machine.id %>/delete'>[x]</a></p>
            <% }) %>
          <% } else { %>
            <p>No machines here :(</p>
          <% } %>
        </div>

        <header class="dashboard-section-header">
          <h3>My Grinders</h3>
          <span class="header-links"><a class="link" href="/users/me/grinders/new">Add Grinders</a></span>
        </header>
        <div class="section-underline"></div>
        
        <div>
          <% if (user.grinders.length) { %>
            <% user.grinders.forEach(grinder => { %>
              <p><strong><%= grinder.brand %></strong> <%= grinder.name %> <a class="link delete" href='/users/me/grinders/<%= grinder.id %>/delete'>[x]</a></p>
            <% }) %>
          <% } else { %>
            <p>No grinders here :(</p>
          <% } %>
        </div>
    </div>
  <%- include('../includes/aside-quote') %>
<%- include('../includes/row-close') %>